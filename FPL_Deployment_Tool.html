<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FPL Dashboard ‚Äî Customer Deployment Tool</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700;800;900&family=Rajdhani:wght@300;400;500;600;700&family=Share+Tech+Mono&display=swap" rel="stylesheet">
<style>
:root{--bg:#06060c;--bg2:#0c0c16;--bg3:#12121e;--border:#1a1a30;--cyan:#00f0ff;--pink:#ff2d7b;--purple:#a855f7;--green:#22c55e;--text:#e2e8f0;--dim:#4a5568}
*{margin:0;padding:0;box-sizing:border-box}
body{background:var(--bg);color:var(--text);font-family:'Rajdhani',sans-serif;min-height:100vh;padding:40px 20px}
.container{max-width:800px;margin:0 auto}
.header{text-align:center;margin-bottom:40px}
.header h1{font-family:'Orbitron',sans-serif;font-size:24px;font-weight:900;letter-spacing:3px;background:linear-gradient(135deg,#fff,var(--cyan),var(--pink));-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:6px}
.header p{font-family:'Share Tech Mono',monospace;font-size:11px;color:var(--dim);letter-spacing:2px}

.card{background:var(--bg3);border:1px solid var(--border);padding:24px;margin-bottom:16px;position:relative;overflow:hidden}
.card::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;background:linear-gradient(90deg,var(--cyan),var(--pink),var(--purple));animation:edge 3s linear infinite;background-size:200% 100%}
@keyframes edge{0%{background-position:0% 0%}100%{background-position:200% 0%}}
.card h2{font-family:'Orbitron',sans-serif;font-size:13px;font-weight:700;letter-spacing:2px;text-transform:uppercase;margin-bottom:4px}
.card .sub{font-family:'Share Tech Mono',monospace;font-size:10px;color:var(--dim);margin-bottom:16px;letter-spacing:1px}

.field{margin-bottom:14px}
.field label{display:block;font-family:'Share Tech Mono',monospace;font-size:9px;letter-spacing:2px;text-transform:uppercase;color:var(--cyan);margin-bottom:4px}
.field input,.field select,.field textarea{width:100%;background:var(--bg2);border:1px solid var(--border);color:var(--text);font-family:'Rajdhani',sans-serif;font-size:14px;font-weight:500;padding:8px 12px;outline:none;transition:border-color .3s}
.field input:focus,.field select:focus,.field textarea:focus{border-color:var(--cyan)}
.field textarea{min-height:80px;font-family:'Share Tech Mono',monospace;font-size:11px;resize:vertical}
.field .hint{font-family:'Share Tech Mono',monospace;font-size:9px;color:var(--dim);margin-top:3px}

.color-row{display:flex;gap:12px;flex-wrap:wrap}
.color-field{flex:1;min-width:140px}
.color-field label{display:block;font-family:'Share Tech Mono',monospace;font-size:9px;letter-spacing:2px;text-transform:uppercase;color:var(--cyan);margin-bottom:4px}
.color-field .cw{display:flex;gap:6px;align-items:center}
.color-field input[type="color"]{width:36px;height:30px;border:1px solid var(--border);background:var(--bg2);cursor:pointer;padding:2px}
.color-field input[type="text"]{flex:1;background:var(--bg2);border:1px solid var(--border);color:var(--text);font-family:'Share Tech Mono',monospace;font-size:11px;padding:6px 8px;outline:none}

.btn{background:var(--cyan);border:none;color:var(--bg);font-family:'Orbitron',sans-serif;font-size:12px;font-weight:700;padding:12px 24px;cursor:pointer;letter-spacing:2px;transition:all .3s;margin-right:8px}
.btn:hover{box-shadow:0 0 25px rgba(0,240,255,.4)}
.btn.pink{background:var(--pink)}
.btn.pink:hover{box-shadow:0 0 25px rgba(255,45,123,.4)}
.btn.secondary{background:transparent;border:1px solid var(--border);color:var(--text)}
.btn.secondary:hover{border-color:var(--cyan);color:var(--cyan)}

.status{font-family:'Share Tech Mono',monospace;font-size:11px;color:var(--green);margin-top:12px;letter-spacing:1px;display:none}

.template-box{background:var(--bg2);border:1px solid var(--border);padding:14px;font-family:'Share Tech Mono',monospace;font-size:10px;color:var(--dim);white-space:pre-wrap;max-height:300px;overflow-y:auto;margin-top:10px;line-height:1.6}

.steps{counter-reset:step}
.step{counter-increment:step;padding-left:30px;position:relative;margin-bottom:14px}
.step::before{content:counter(step);position:absolute;left:0;top:0;width:22px;height:22px;background:var(--cyan);color:var(--bg);font-family:'Orbitron',sans-serif;font-size:10px;font-weight:700;display:flex;align-items:center;justify-content:center}
.step p{font-size:13px;line-height:1.5}
.step code{background:var(--bg2);padding:1px 6px;font-family:'Share Tech Mono',monospace;font-size:11px;color:var(--cyan);border:1px solid var(--border)}
</style>
</head>
<body>
<div class="container">
  <div class="header">
    <h1>DEPLOYMENT TOOL</h1>
    <p>Generate customized dashboards for each customer</p>
  </div>

  <div class="card">
    <h2>üìã How It Works</h2>
    <div class="sub">3 steps to deploy a customer dashboard</div>
    <div class="steps">
      <div class="step"><p>Fill in the customer details below ‚Äî their Google Sheet ID, league name, password, colors, etc.</p></div>
      <div class="step"><p>Click <strong>GENERATE DASHBOARD</strong> ‚Äî downloads a custom HTML file with their config baked in.</p></div>
      <div class="step"><p>Customer adds a <code>Config</code> tab to their Google Sheet (template provided). They can edit it anytime to change branding/colors/tabs ‚Äî changes appear live on their dashboard.</p></div>
    </div>
  </div>

  <div class="card">
    <h2>üîë Customer Access</h2>
    <div class="sub">Set the admin password for this customer</div>
    <div class="field"><label>Customer Name</label><input type="text" id="d_customerName" placeholder="e.g. Coastal League, FPL Season 4"><div class="hint">Used for the filename only</div></div>
    <div class="field"><label>Admin Password</label><input type="text" id="d_password" placeholder="e.g. coastal2025"><div class="hint">Customer uses this to access admin panel on their dashboard</div></div>
  </div>

  <div class="card">
    <h2>üìä Data Source</h2>
    <div class="sub">Their Google Sheets connection</div>
    <div class="field"><label>Google Sheet ID</label><input type="text" id="d_sheetId" placeholder="1QBei0BJqnxJLu68sxNoW8sJCR3SElQA0g_ESQMecHlU"><div class="hint">The long ID from the Google Sheets URL ‚Äî sheet must be published to web</div></div>
    <div class="field"><label>Data Sheet Tab Name</label><input type="text" id="d_sheetName" value="Sheet1" placeholder="Sheet1"><div class="hint">Name of the tab with match data</div></div>
  </div>

  <div class="card">
    <h2>üè∑ Branding</h2>
    <div class="sub">Default branding ‚Äî customer can override via their Config sheet tab</div>
    <div class="field"><label>League / Tournament Name</label><input type="text" id="d_leagueName" value="FRANCHISE PREMIER LEAGUE"></div>
    <div class="field"><label>Subtitle</label><input type="text" id="d_subtitle" value="PLAYER PERFORMANCE DASHBOARD"></div>
    <div class="field"><label>Season Badge</label><input type="text" id="d_seasonLabel" value="Season 1 // Official Stats"></div>
    <div class="field"><label>Credit Line</label><input type="text" id="d_creditLine" value="Stats Dashboard"></div>
    <div class="field"><label>Logo URL (optional)</label><input type="text" id="d_logoUrl" placeholder="https://..."></div>
  </div>

  <div class="card">
    <h2>üé® Colors</h2>
    <div class="sub">Default colors ‚Äî customer can override via their Config sheet tab</div>
    <div class="color-row">
      <div class="color-field"><label>Primary</label><div class="cw"><input type="color" id="d_c1c" value="#00f0ff" oninput="document.getElementById('d_c1').value=this.value"><input type="text" id="d_c1" value="#00f0ff" oninput="document.getElementById('d_c1c').value=this.value"></div></div>
      <div class="color-field"><label>Secondary</label><div class="cw"><input type="color" id="d_c2c" value="#ff2d7b" oninput="document.getElementById('d_c2').value=this.value"><input type="text" id="d_c2" value="#ff2d7b" oninput="document.getElementById('d_c2c').value=this.value"></div></div>
      <div class="color-field"><label>Accent</label><div class="cw"><input type="color" id="d_c3c" value="#a855f7" oninput="document.getElementById('d_c3').value=this.value"><input type="text" id="d_c3" value="#a855f7" oninput="document.getElementById('d_c3c').value=this.value"></div></div>
    </div>
  </div>

  <div class="card">
    <h2>‚ö° Generate</h2>
    <div class="sub">Build the custom dashboard file</div>
    <button class="btn" onclick="generateDashboard()">üöÄ GENERATE DASHBOARD</button>
    <button class="btn secondary" onclick="generateConfigTemplate()">üìÑ CONFIG SHEET TEMPLATE</button>
    <div class="status" id="genStatus"></div>
  </div>

  <div class="card" id="configTemplateCard" style="display:none">
    <h2>üìÑ Config Sheet Template</h2>
    <div class="sub">Customer adds a tab called "Config" to their Google Sheet with these rows</div>
    <p style="font-size:12px;margin-bottom:10px;color:var(--dim)">Column A = Key, Column B = Value. Customer edits Column B to customize their dashboard live.</p>
    <div class="template-box" id="configTemplate"></div>
    <button class="btn secondary" style="margin-top:10px" onclick="copyTemplate()">üìã COPY TO CLIPBOARD</button>
  </div>
</div>

<script>
const DASHBOARD_URL='FPL3_Season3_Stats_Enhanced.html';

function generateConfigTemplate(){
  const name=document.getElementById('d_leagueName').value||'MY LEAGUE';
  const sub=document.getElementById('d_subtitle').value||'PLAYER PERFORMANCE DASHBOARD';
  const season=document.getElementById('d_seasonLabel').value||'Season 1 // Official Stats';
  const credit=document.getElementById('d_creditLine').value||'Stats Dashboard';
  const logo=document.getElementById('d_logoUrl').value||'';
  const c1=document.getElementById('d_c1').value||'#00f0ff';
  const c2=document.getElementById('d_c2').value||'#ff2d7b';
  const c3=document.getElementById('d_c3').value||'#a855f7';

  const template=`Key\tValue
leagueName\t${name}
subtitle\t${sub}
seasonLabel\t${season}
creditLine\t${credit}
footerText\t${name} ‚Äî POWERED BY RIOT API ‚Äî LIVE FROM GOOGLE SHEETS
colorPrimary\t${c1}
colorSecondary\t${c2}
colorAccent\t${c3}
colorBg\t#06060c
logoUrl\t${logo}
minGamesDefault\t5
tabLeaderboard\ttrue
tabTeams\ttrue
tabChampions\ttrue
tabRecords\ttrue
tabMvp\ttrue
tabPower\ttrue
tabLookup\ttrue
tabOrder\tleaderboard,teams,champions,records,mvp,power,lookup`;

  document.getElementById('configTemplate').textContent=template;
  document.getElementById('configTemplateCard').style.display='';
}

function copyTemplate(){
  const text=document.getElementById('configTemplate').textContent;
  navigator.clipboard.writeText(text).then(()=>{
    showStatus('Template copied! Paste into Google Sheets as a new tab called "Config"');
  });
}

function showStatus(msg){
  const el=document.getElementById('genStatus');
  el.textContent=msg;el.style.display='block';
  setTimeout(()=>el.style.display='none',4000);
}

async function generateDashboard(){
  const customerName=document.getElementById('d_customerName').value.trim()||'Customer';
  const password=document.getElementById('d_password').value.trim();
  const sheetId=document.getElementById('d_sheetId').value.trim();
  const sheetName=document.getElementById('d_sheetName').value.trim()||'Sheet1';

  if(!password){showStatus('‚ö† Please set an admin password');return}
  if(!sheetId){showStatus('‚ö† Please enter a Google Sheet ID');return}

  const leagueName=document.getElementById('d_leagueName').value.trim()||'MY LEAGUE';
  const subtitle=document.getElementById('d_subtitle').value.trim()||'PLAYER PERFORMANCE DASHBOARD';
  const seasonLabel=document.getElementById('d_seasonLabel').value.trim()||'Season 1';
  const creditLine=document.getElementById('d_creditLine').value.trim()||'';
  const logoUrl=document.getElementById('d_logoUrl').value.trim()||'';
  const c1=document.getElementById('d_c1').value;
  const c2=document.getElementById('d_c2').value;
  const c3=document.getElementById('d_c3').value;

  showStatus('Fetching base dashboard...');

  try{
    // Try to fetch the base dashboard file
    let baseHTML='';
    try{
      const resp=await fetch(DASHBOARD_URL);
      baseHTML=await resp.text();
    }catch(e){
      // If fetch fails, prompt for file upload
      showStatus('‚ö† Could not auto-fetch dashboard. Upload the base HTML file manually.');
      return;
    }

    // Replace the SHEET_ID
    baseHTML=baseHTML.replace(
      /const SHEET_ID='[^']*'/,
      `const SHEET_ID='${sheetId}'`
    );

    // Replace admin passwords
    baseHTML=baseHTML.replace(
      /const ADMIN_PASSWORDS=\{[^}]*\}/,
      `const ADMIN_PASSWORDS={'${password}':'admin'}`
    );

    // Replace default config values
    baseHTML=baseHTML.replace(
      /sheetId:'[^']*'/,
      `sheetId:'${sheetId}'`
    );
    baseHTML=baseHTML.replace(
      /leagueName:'[^']*'/,
      `leagueName:'${leagueName}'`
    );
    baseHTML=baseHTML.replace(
      /subtitle:'[^']*'/,
      `subtitle:'${subtitle}'`
    );
    baseHTML=baseHTML.replace(
      /seasonLabel:'[^']*'/,
      `seasonLabel:'${seasonLabel}'`
    );
    baseHTML=baseHTML.replace(
      /creditLine:'[^']*'/,
      `creditLine:'${creditLine}'`
    );
    baseHTML=baseHTML.replace(
      /colorPrimary:'[^']*'/,
      `colorPrimary:'${c1}'`
    );
    baseHTML=baseHTML.replace(
      /colorSecondary:'[^']*'/,
      `colorSecondary:'${c2}'`
    );
    baseHTML=baseHTML.replace(
      /colorAccent:'[^']*'/,
      `colorAccent:'${c3}'`
    );
    if(sheetName!=='Sheet1'){
      baseHTML=baseHTML.replace(
        /sheetName:'[^']*'/,
        `sheetName:'${sheetName}'`
      );
    }

    // Download
    const blob=new Blob([baseHTML],{type:'text/html'});
    const link=document.createElement('a');
    const safeName=customerName.replace(/[^a-zA-Z0-9]/g,'_');
    link.download=`Dashboard_${safeName}.html`;
    link.href=URL.createObjectURL(blob);
    link.click();

    showStatus(`‚úì Dashboard_${safeName}.html generated! Don't forget to have customer add a "Config" tab to their sheet.`);

    // Also generate template
    generateConfigTemplate();

  }catch(e){
    showStatus('‚ö† Error: '+e.message);
  }
}
</script>
</body>
</html>
